<!--
  This file is part of the "FnordMetric" project
    Copyright (c) 2014 Laura Schlimmer
    Copyright (c) 2014 Paul Asmuth, Google Inc.

  FnordMetric is free software: you can redistribute it and/or modify it under
  the terms of the GNU General Public License v3.0. You should have received a
  copy of the GNU General Public License along with this program. If not, see
  <http://www.gnu.org/licenses/>.
-->
<html>
  <head>
    <title>Metric Explorer</title>
    <link rel="stylesheet" href="../fnord.css" type="text/css">
    <link rel="stylesheet" href="../3rdparty/fontawesome.css" type="text/css">
    <link rel="stylesheet" href="fn-metric-explorer.css" type="text/css">
  </head>
  <body>
    <link rel="import" href="metric-explorer-components/metric-explorer-list.html" data-component="fn-metric-explorer-list">
    <link rel="import" href="metric-explorer-components/metric-explorer-search.html" data-component="fn-metric-explorer-search">
    <link rel="import" href="../components/fn-appbar.html" data-component="fn-appbar">
    <link rel="import" href="../components/fn-button.html" data-component="fn-button">
    <link rel="import" href="../components/fn-loader.html" data-component="fn-loader">
    <link rel="import" href="../components/fn-menu.html" data-component="fn-menu">
    <link rel="import" href="../components/fn-search.html" data-component="fn-search">
    <link rel="import" href="../components/fn-table.html" data-component="fn-table">
    <link rel="import" href="../components/fn-progressbar.html" data-component="fn-progressbar">
    <link rel="import" href="../components/fn-dropdown.html" data-component="fn-dropdown">
    <link rel="stylesheet" href="../themes/midnight-blue.css" type="text/css">


    <div id="metric-explorer-viewport">
    </div>


  </body>
</html>

<script type='text/javascript'>

  var views = {
    "metric-explorer-list" : "<fn-metric-explorer-list></fn-metric-explorer-list>",
    "metric-explorer-preview" : "<fn-metric-explorer-preview></fn-metric-explorer-preview>",
    "metric-explorer-search" : "<fn-metric-explorer-search></fn-metric-explorer-search>"
  }

  var routes = {
    "metric-explorer-list" : "metrics",
    "metric-explorer-preview" : "metric",
    "metric-explorer-search" : "search"
  }

  function open(name, url_fragment) {
    var viewport = document.querySelector("#metric-explorer-viewport");


    var view = (name) ? views[name] : views["metric-explorer-search"];
    console.log(view)
    viewport.innerHTML = view;

    if (url_fragment) {
      window.location.hash = routes[name] + "?" + url_fragment;
    }
  }

  function parseUrlHash(hash) {
    var view;
    var query_params = {};

    if (hash.indexOf("?") >= 0) {
      view = hash.substr(0, hash.indexOf("?")).replace("#", "");

      var raw_params = hash.substr(hash.indexOf("?") + 1).split('&');

      for (var i = 0; i < raw_params.length; i++) {
        var param = (raw_params[i].split('=') != "undefined") ? 
          raw_params[i].split('=') : "";
        if (param[0] != "undefined") {
          query_params[decodeURIComponent(param[0])] =
             (param[1] != "undefined") ? 
             decodeURIComponent(param[1]) : "";
        }
      }

    } else {
      view = (hash && hash != "undefined") ? hash : "";
    }

    return {
      "view" : view,
      "q_params" : query_params
    }
  }

  window.addEventListener('fn-ready' ,function() {
    open();
  }, false)
</script>
<script type='text/javascript' src='../fnord.js'></script>
